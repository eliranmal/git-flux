#!/usr/bin/env bash

exec 1>&2

main() {
	log "pre-push hook called with args: [$@]"
	render_usage_docs
}

render_usage_docs() {
	local git_root="$(git rev-parse --show-toplevel)"
	# install git-flux from source - required for the usage.sh script
	env REPO_PATH=${git_root} ${git_root}/bin/setup.sh update || { exit 1; }
	# render usage docs with the script
#	${git_root}/bin/usage.sh || { exit 2; }
	${git_root}/usage.sh || { exit 2; }
}

log() {
	echo " > $1"
}

main "$@"

exit 0
